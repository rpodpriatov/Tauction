Как настроить бота для работы с платежами
Обратите внимание: дальше речь пойдёт о настройке бота через API Telegram. Если вы используете конструктор ботов (Manybot, Botobot, Botmaker или любой другой), следуйте его инструкциям.
Реализуйте метод sendinvoice из платёжного API Telegram: в ответ на этот запрос ваш бот будет отправлять клиенту счёт на оплату. В счёте должна быть стоимость, название, описание товара, параметр payload и параметр provider_token — это тот самый токен, который выдал @BotFather после подключения вашего бота к боту ЮKassa.
Обратите внимание, что платежи для тестового магазина должны быть не более 1000 рублей.
Посмотреть пример запроса sendinvoice

Если вы настраивали фискализацию через ЮKassa**, нужно передавать в ЮKassa данные для фискализации. Для этого добавьте в запрос следующие параметры:
need_phone_number или need_email
send_email_to_provider (если вы запрашивали у клиента электронную почту) илиsend_phone_number_to_provider (если вы запрашивали у клиента телефон),
provider_data и в нём объект receipt. Подробности — в API ЮKassa (смотрите раздел Атрибуты — receipt).
Посмотреть пример

Телефон или почту вы можете запросить у клиента раньше, в диалоге с ботом. Тогда первые два параметра не нужны, достаточно provider_data с объектом receipt.
Посмотреть пример

Подробнее про 54-ФЗ в работе с ЮKassa
Если вам нужно получить от клиента адрес для доставки, реализуйте метод Shipping Query. Когда пользователь укажет адрес, на этот запрос нужно ответить методом answerShippingQuery. В этом методе нужно передать способы доставки и их цены.
Когда пользователь подтвердит платёж, Telegram пришлёт вам webhook с Update, который содержит объект PreCheckoutQuery. На этот запрос нужно ответить в течение 10 секунд, вызвав метод answerPreCheckoutQuery.
Если платёж пройдёт успешно, вы получите два уведомления: от Telegram (webhook с объектом SuccessfulPayment) и от ЮKassa (email). Бота можно запрограммировать так, чтобы после успешного платежа он совершал определённое действие: например, подключал покупателю услугу или отправлял контент.
В объекте SuccessfulPayment из уведомления от Telegram найдите параметр provider_payment_charge_id: там будет номер транзакции в ЮKassa. Этот номер лучше сохранить: по нему можно будет найти платёж в личном кабинете.